
> [如何优雅的使用docker](https://zhuanlan.zhihu.com/p/270261871)
> [docker15问](https://blog.csdn.net/weixin_41645135/article/details/125513040)
## docker 是什么 用来干啥 有怎样的应用场景

#### 虚拟机、沙盒、容器

__虚拟机__ 是在计算机中模拟另一个计算机的技术，重点在于模拟和另一个计算机。因此虚拟机需要先将物理机的硬件进行封装，并部署一个独立的操作系统。独立的操作系统调用模拟的硬件，实现各种功能。对于运行在虚拟机内的系统来说，它似乎就在一个真正的物理机上运行，不会受到过多的限制。

__沙盒__ 用途是隔离运行环境，而非模拟计算机。因此它不需要虚拟化硬件，也不需要安装独立的操作系统。

__容器__ 则类似于沙盒的增强版，其允许通过配置有目的性地允许某些穿透操作（如将容器端口映射到宿主系统、访问宿主系统的某个目录）。同时，也允许在容器中部署一个与宿主系统相似但不同的操作系统（这里主要指可以诸如在 Arch Linux 使用 Ubuntu 镜像，但是如果是 Windows，其无法直接使用 Linux 镜像，需要先使用 Hyper-V 虚拟一个 Linux）。

所以，相对于 __虚拟机__ ， __容器__ 更为轻量级（只是替换子进程的系统调用，而非模拟硬件且安装完整的操作系统）；相对于 __沙盒__ ，容器可操作性更多（可以有选择性地允许与宿主系统进行交互）。因此也可以将沙盒理解为一种特殊的容器。这也就是 Docker 在开发中受到广泛推崇的原因，==它可以隔离出一个自定义环境、部署快、允许有选择地穿透==。刚好满足开发和部署过程中容易遇到的环境不一致问题。

## docker 如何使用 

#### 安装

安装对于正常环境（如 Windows、Linux）可以直接在官网安装 Docker 即可。

而如果想要在 WSL2 中使用 Docker，则需要参考 [Docker Desktop WSL 2 backend](https://docs.docker.com/desktop/windows/wsl/) 和 [Using Docker in WSL2](https://code.visualstudio.com/blogs/2020/03/02/docker-in-wsl2) 
Docker分为两部分：服务端、客户端。
所有的容器都会保存、运行在服务端，客户端仅仅用于控制。以 WSL2 为例，实际上 Docker 运行在 Hyper-V 的虚拟机中，客户端在 WSL 中操作 Windows 下的 Docker 控制虚拟机中的 Docker。在大部分情况下可能不需要考虑这些关系，但是在需要通过 IP 端口互联时，需要确定到底要连到哪一个局域网 IP。
如果要通过 Docker 连回服务端所在设备，可以使用`host.docker.internal`

#### 镜像

镜像是对于一些环境的封装（打包好的环境）。可以将其理解成安装包、压缩包，__其本身是不可改动的__ 。一般而言，镜像会基于官方提供的一些系统为基础（如常用的是 Ubuntu，也可以基于没有操作系统的 scratch），安装相应依赖程序为某些特定程序提供服务。

#### 镜像信息查看

使用docker images可以获取所有本地存在的镜像，包含 5 列信息：

+ 镜像名称（包含用户名、镜像名）
+ 标签（版本）
+ 镜像 ID（哈希值）
+ 创建时间（镜像本身创建时间，而非下载或本地生成时间）
+ 镜像大小（本镜像所有分层总大小）

由于前面提到的分层概念，实际上这里的镜像大小之和应该大于或等于实际占用大小（多个镜像可能包含相同的分层）。



